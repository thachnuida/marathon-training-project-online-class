{% extends 'base.html' %}
{% load url from future %}
{% load staticfiles %}
{% block title %}Exercise History{% endblock %}
{% block link %}
	{{ block.super }}
	<link href="{% static 'class_management/css/style.css' %}" rel="stylesheet">
{% endblock %}
{% block body %}
	<div id="test_history">
		<div id="student">
			{% if user.user_image %}
				<img src="{{ user.user_image}}"/>
			{% else %}
				<img src="{% static 'home/img/account.png' %}"/>
			{% endif %}
			<div style="margin-top: 10px;">{{ user.username }}</div>
			<div id="sort">
				<div class="title">Sort</div>
				<div id="sort_option">
					<div id="sort_lesson"><img src="{% static 'class_management/images/Sort-Lesson-icon.png' %}"/><span class="option">Lesson</span></div>
					<div id="sort_score"><img src="{% static 'class_management/images/Sort-Score-icon.png' %}"/><span class="option">Score</span></div>
					<div id="sort_time"><img src="{% static 'class_management/images/Sort-Time-icon.png' %}"/><span class="option">Time</span></div>
				</div>
			</div>
		</div>
		<div id="history">
			<div class="fill-green">Exercise History - {{ chosen_class.class_name }} Class</div>
			<div class="substrate">
				{% if test_list|length == 0 %}
					<div class="nonhaving">Any Exercise Haven't Been Done!</div>
				{% else %}
					<div class="left-blue">
						{% for test in test_list %}
						<div class="muc">
							<div class="time-period-left-blue"></div>
							<h4>
								Score: {{ test.score }}/{{ test.question_num }}	<span class="time-period-right-blue">{{ test.test_date|date:"H:i d/m/Y" }}</span>
							</h4>
							<ul class="main-info-list">
								<li>Lesson <span>{{ test.test.lesson}}</span></li>
								<li>Exercise<span>{{ test.test }}</span>
								</li>
							</ul>
						</div>
						{% endfor %}
					</div>
				{% endif %}
			</div>
		</div>
	</div>
{% endblock %}
{% block script %}
	<script type="text/javascript">
	$(document).ready(function(){
	$("#sort_option").children().click(function(){
		$("#sort_option").children().css('background', '');
		$(this).css('background', 'rgb(223, 217, 217)');
		$.ajax({
    		type:"POST",
    		url : "{% url 'classes:testhistory' user.pk chosen_class.pk %}",
    		dataType: "html",
    		data : { 
    			csrfmiddlewaretoken : '{{ csrf_token }}',
    			option: $(this).find('.option').html(),
    	},
    		success : function(question_dict){
                $(".left-blue").html(question_dict);
   			},
   			error: function(errors_dict){
                alert("false");
			}
    		});
	});
});
	</script>
{% endblock %}